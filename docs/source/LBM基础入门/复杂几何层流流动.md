# 复杂几何层流流动
文档视频讲解：

> [LBM求解Couette(库埃特)流动：Zou-He与非平衡外推边界条件](https://www.bilibili.com/video/BV1PkcueFE2z/?share_source=copy_web&vd_source=6cb794fb9d90103946fb79ba5f60451f)


## 半反弹边界条件
相信大家都听说过，LBM具有边界条件容易实现的优点。其实，这一点主要体现在半反弹边界的实现上。其他边界相比于传统方法也并没有太大的优势。下面我们就介绍一下半反弹边界条件。

半反弹边界条件是一种用于处理固体边界的简单而有效的方法。**其基本思想是，当粒子分布函数碰到固体边界时，沿着入射方向的分布函数将被反弹回去，沿着相反方向的分布函数将被更新为入射方向的值。**

示意图如下所示：

 ```{figure} fig/fig5/半反弹边界示意图.png
:width: 50%
:alt: logo
:align: center
半反弹边界示意图
```

具体来说，假设在某个时间步$t$，位置$\boldsymbol{x}$处的粒子分布函数$f_\alpha (\boldsymbol{x},t)$沿着方向$\boldsymbol{e}_\alpha$入射到固体边界上，那么在下一个时间步$t+\delta_t$，该位置处的粒子分布函数将被更新为：

$$
f_{\bar{\alpha}} (\boldsymbol{x},t+\delta_t) = f_\alpha (\boldsymbol{x},t)
$$

其中，$\bar{\alpha}$表示与方向$\alpha$相反的方向。

这种边界条件的优点在于其实现简单，计算效率高，并且能够很好地保持质量守恒。最重要的是，从上式中可以看到，半反弹边界的实现只需要本地的信息，不需要周围节点的信息，这使得其在并行计算中非常高效。

当然，半反弹边界条件也有其局限性。例如，如下图中所示，对于半反弹边界，真实壁面与虚拟壁面之间会存在偏差，如下图中所示：计算中认为的壁面位置是在两个格点中间，而真实壁面有可能在两个格点间的任意位置，这就会带来一定的误差。

 ```{figure} fig/fig5/半反弹所带来的误差.png
:width: 50%
:alt: logo
:align: center
半反弹真实壁面与计算壁面的偏差
```

## 作用力格式
在上一节中，我们介绍了如何通过半反弹边界条件来处理固体边界。为了实现对计算域内任意复杂多孔结构进行流动模拟，我们之前介绍的在进出口施加压力差进行驱动的方式就不太适用，因为复杂多孔结构中很难定义清晰的进出口压力。为了解决这个问题，我们可以改为外力驱动的方式来实现流动模拟。

之后我们会将LBM中常见的所有作用力模型都进行整理，这里我们仅介绍最常见的作用力格式——Guo作用力格式。对于该作用力格式，我们只需要在LBM的演化方程中增加一个源项即可：
$$f_{\alpha}^{*}(\boldsymbol{x},t)=f_{\alpha}(\boldsymbol{x},t)-\frac{1}{\tau}[f_{\alpha}(\boldsymbol{x},t)-f_{\alpha}^{\mathrm{eq}}(\boldsymbol{x},t)]+{\color[RGB]{240, 0, 0} F_{\alpha}}$$

其中，
$${\color[RGB]{240, 0, 0} F_{\alpha}=\delta _t\omega _\alpha\left( 1-\frac{1}{2\tau} \right) \left[ \frac{\boldsymbol{e}_\alpha-\boldsymbol{u}}{c_{s}^{2}}+\frac{(\boldsymbol{e}_\alpha\cdot \boldsymbol{u})\boldsymbol{e}_\alpha}{c_{s}^{4}} \right] \cdot \boldsymbol{F}}$$

这里的$\boldsymbol{F}$表示外力。同时还需对速度的计算进行修正：
$$\rho \boldsymbol{u} = \sum_\alpha f_\alpha \boldsymbol{e_\alpha} + \frac{\delta_t}{2} \boldsymbol{F}$$


## 代码下载
[库埃特流动.zip](https://raw.githubusercontent.com/JR-LBM-THU/JRLBM-tutorial/main/docs/source/LBM基础入门/files/4.1库埃特流动.zip)

[泊肃叶流动.zip](https://raw.githubusercontent.com/JR-LBM-THU/JRLBM-tutorial/main/docs/source/LBM基础入门/files/4.2泊肃叶流动.zip)
