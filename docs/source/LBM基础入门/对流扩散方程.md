# å¯¹æµæ‰©æ•£æ–¹ç¨‹
æ–‡æ¡£è§†é¢‘è®²è§£ï¼š
> [æ ¼å­ç»å°”å…¹æ›¼æ–¹æ³•(LBM)æ±‚è§£å¯¹æµæ‰©æ•£æ–¹ç¨‹](https://www.bilibili.com/video/BV1X4BGY4Ei5/?share_source=copy_web&vd_source=6cb794fb9d90103946fb79ba5f60451f)

è¿™èŠ‚æˆ‘ä»¬ä»‹ç»ä¸€ä¸‹**å¯¹æµæ‰©æ•£**æ–¹ç¨‹çš„æ ¼å­ç»å°”å…¹æ›¼æ–¹æ³•å®ç°ã€‚åŒ…æ‹¬ä¸€ç»´å’ŒäºŒç»´ã€‚
## ä»€ä¹ˆæ˜¯å¯¹æµæ‰©æ•£æ–¹ç¨‹ï¼Ÿ
æ‰©æ•£æ–¹ç¨‹æˆ‘ä»¬ä¹‹å‰å·²ç»è¿›è¡Œäº†ä»‹ç»ã€‚é‚£æˆ‘ä»¬é¦–å…ˆæ¥çœ‹ä¸€ä¸‹ä»€ä¹ˆæ˜¯**å¯¹æµæ–¹ç¨‹**ã€‚å¯¹äºä¸€ç»´é—®é¢˜ï¼Œå¯¹æµæ–¹ç¨‹æ˜¯è¿™æ ·çš„ï¼š

$$
\frac{\partial \phi}{\partial t} + u \frac{\partial \phi}{\partial x}=0
$$

å…¶ä¸­$u$è¡¨ç¤ºå¯¹æµé€Ÿåº¦ã€‚æˆ‘ä»¬çŸ¥é“$\phi(x,t)$æ˜¯ç©ºé—´å’Œæ—¶é—´çš„å‡½æ•°ï¼Œæ‰€ä»¥ä¸Šå¼å…¶å®è¡¨å¾çš„æ„æ€æ˜¯$\phi$å¯¹æ—¶é—´çš„å…¨å¯¼æ•°ï¼Œå³:

$$
\frac{\mathrm{d} \phi(x,t)}{\mathrm{d} t}=\frac{\partial \phi}{\partial t} + \frac{\partial x}{\partial t} \frac{\partial \phi}{\partial x}=\frac{\partial \phi}{\partial t} + u \frac{\partial \phi}{\partial x}=0
$$

è¿™é‡Œ$u=\partial x/\partial t$ï¼Œè¡¨å¾$\phi$ç§»åŠ¨çš„é€Ÿåº¦ã€‚ä¸‹å›¾æ˜¯ä¸€ä¸ªå¯¹æµæ–¹ç¨‹ç»“æœçš„ç»å…¸å±•ç¤ºï¼š

<!-- <img src="./fig/å¯¹æµç¤ºæ„å›¾.png" alt="Image description" width="500"/> -->
 ```{figure} fig/fig3/å¯¹æµç¤ºæ„å›¾.png
:width: 50%
:alt: logo
:align: center
å›¾ä¸­$u=1$
```

é‚£ä¹ˆå¯¹æµæ‰©æ•£æ–¹ç¨‹ï¼Œå°±æ˜¯æ—¢åŒ…å«å¯¹æµé¡¹ï¼Œä¹ŸåŒ…å«æ‰©æ•£ã€‚ä¸€ç»´æƒ…å†µä¸‹ï¼Œæ–¹ç¨‹å¦‚ä¸‹ï¼š

$$
\frac{\partial \phi}{\partial t} + u \frac{\partial \phi}{\partial x} = \alpha \frac{\partial^2 \phi}{\partial x^2}
$$

å†™æˆé«˜ç»´çŸ¢é‡å½¢å¼ç»´ï¼š

$$
\frac{\mathrm{d} \phi(\boldsymbol{x},t)}{\mathrm{d} t}=\frac{\partial \phi}{\partial t} +\boldsymbol{u}\cdot \nabla \phi = \alpha \nabla^2 \phi
$$

è¿™é‡Œçš„$\boldsymbol{x}$è¡¨ç¤ºä½ç½®çŸ¢é‡ï¼Œ$\boldsymbol{u}$è¡¨ç¤ºé€Ÿåº¦çŸ¢é‡ã€‚å±•å¼€åˆ°äºŒç»´ï¼š

$$
\frac{\partial \phi}{\partial t} + u_x \frac{\partial \phi}{\partial x} + u_y \frac{\partial \phi}{\partial y}=\alpha\left(\frac{\partial^2 \phi}{\partial x^2}+\frac{\partial^2 \phi}{\partial y^2}\right)
$$

æ³¨ï¼Œå…¶å®å°†$\phi$æ¢æˆ$T$å°±æ˜¯è´¨é‡ã€åŠ¨é‡ã€èƒ½é‡æ–¹ç¨‹ä¸­çš„èƒ½é‡æ–¹ç¨‹ã€‚å°†$\phi$æ¢æˆ$\rho \boldsymbol{u}$å°±æ˜¯åŠ¨é‡æ–¹ç¨‹ã€‚
## ä¸€ç»´å¯¹æµæ‰©æ•£æ–¹ç¨‹çš„D1Q3æ¨¡å‹
> ä¸‰ä¸ªç¦»æ•£é€Ÿåº¦

$$
e_0 = 0, \quad e_1 = c, \quad e_2 = -c
$$

å…¶ä¸­$c=\delta_x/\delta_t$, $\delta_x$æ˜¯ç©ºé—´æ­¥é•¿ï¼Œ$\delta_t$æ˜¯æ—¶é—´æ­¥é•¿ã€‚
> å¯¹åº”çš„æƒé‡

$$
w_0 = 4/6, \quad w_1 = w_2 = 1/6
$$

> å¹³è¡¡æ€åˆ†å¸ƒå‡½æ•°ï¼ˆ$c_s^2=c^2/3$ï¼‰

$$
f_i^\mathrm{eq} = w_i \phi\left( 1 + \frac{e_i\cdot u}{c^2_s}\right)
$$

> æ¼”åŒ–æ–¹ç¨‹

$$
f_i(\boldsymbol{x}+\boldsymbol{e}_i \delta_t,t+\delta_t)=f_i(\boldsymbol{x},t)-\frac{1}{\tau}[f_i(\boldsymbol{x},t)-f_i^{\mathrm{eq}}(\boldsymbol{x},t)]
$$

ä¹Ÿå¯ä»¥å†™æˆå¦‚ä¸‹çš„å½¢å¼ï¼š

$$
f_i(\boldsymbol{x}+\boldsymbol{e}_i \delta_t,t+\delta_t)=(1-\omega) f_i(\boldsymbol{x},t)+\omega f_i^{\mathrm{eq}}(\boldsymbol{x},t)
$$

å…¶ä¸­$\omega = 1/\tau$ã€‚
> å®è§‚é‡

$$
\phi= \sum_i f_i
$$

> æ‰©æ•£ç³»æ•°

$$
\alpha = \frac{\delta _x^2}{3\delta_t}\left(\tau - \frac{1}{2}\right)
$$

### ç®—ä¾‹1æ¨¡æ‹Ÿç»“æœ
å·¦ä¾§ä¸º$\phi=1$ï¼Œå³ä¾§ä¸º$\phi=$0ã€‚è®¡ç®—åŸŸé•¿ä¸º100ï¼Œåˆå§‹æ¡ä»¶ä¸º$\phi=0$ã€‚è®¡ç®—çš„å‚æ•°è®¾ç½®ä¸ºçƒ­æ‰©æ•£ç‡$\alpha=0.25$ï¼Œ$\delta_x=1$ï¼Œ$\delta_t=1$ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œæ¸©åº¦ä¼šæ…¢æ…¢æ…¢åŒ–ã€‚
<!-- <img src="./fig/case1-1.png" alt="Image description" width="500"/> -->
 ```{figure} fig/fig3/case1-1.png
:width: 50%
:alt: logo
:align: center
å›¾ä¸­$u=0.1$
```

<!-- <img src="./fig/case1-3.png" alt="Image description" width="500"/> -->
 ```{figure} fig/fig3/case1-3.png
:width: 50%
:alt: logo
:align: center
å›¾ä¸­$u=0.05$
```

<!-- <img src="./fig/case1-2.png" alt="Image description" width="500"/> -->
 ```{figure} fig/fig3/case1-2.png
:width: 50%
:alt: logo
:align: center
å›¾ä¸­$u=0.0$
```

### ç®—ä¾‹2æ¨¡æ‹Ÿç»“æœ
ä¸¤ä¾§å‘¨æœŸæ€§è¾¹ç•Œæ¡ä»¶ã€‚è®¡ç®—åŸŸé•¿ä¸º200ï¼Œ$10<x<30$å†…$\phi=1$ï¼Œå…¶ä»–åŒºåŸŸ$\phi=0$ã€‚è®¡ç®—çš„å‚æ•°è®¾ç½®ä¸ºçƒ­æ‰©æ•£ç‡$\alpha=0.05$ï¼Œ$\delta_x=1$ï¼Œ$\delta_t=1$ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œæ¸©åº¦ä¼šæ…¢æ…¢çš„å˜åŒ–ã€‚
<!-- <img src="./fig/case2-1.png" alt="Image description" width="500"/> -->
 ```{figure} fig/fig3/case2-1.png
:width: 50%
:alt: logo
:align: center
å›¾ä¸­$u=0.1$
```

<!-- <img src="./fig/case2-3.png" alt="Image description" width="500"/> -->
 ```{figure} fig/fig3/case2-3.png
:width: 50%
:alt: logo
:align: center
å›¾ä¸­$u=0.05$
```

<!-- <img src="./fig/case2-2.png" alt="Image description" width="500"/> -->
 ```{figure} fig/fig3/case2-2.png
:width: 50%
:alt: logo
:align: center
å›¾ä¸­$u=0.0$
```

## äºŒç»´å¯¹æµæ‰©æ•£æ–¹ç¨‹çš„D2Q5æ¨¡å‹
ä»ä¸Šé¢çš„ä¸æ‰©æ•£æ–¹ç¨‹çš„æ¯”è¾ƒçœ‹å‡ºï¼Œä½¿ç”¨D1Q3æ¨¡å‹æ±‚è§£å¯¹æµæ‰©æ•£æ–¹ç¨‹ä¸æ±‚è§£æ‰©æ•£æ–¹ç¨‹å”¯ä¸€çš„ä¸åŒå°±æ˜¯å¹³è¡¡æ€åˆ†å¸ƒå‡½æ•°ã€‚åŒæ ·çš„ï¼ŒD2Q5ä¹Ÿå¦‚æ­¤ï¼Œå¹³è¡¡æ€åˆ†å¸ƒå‡½æ•°ä¸ºï¼š

$$
f_i^\mathrm{eq} = w_i \phi\left( 1 + \frac{\boldsymbol{e_i\cdot u}}{c^2_s}\right)
$$

å…¶ä»–çš„å†…å®¹ä¸ä¸Šä¸€ç« ä»‹ç»çš„D2Q5æ±‚è§£æ‰©æ•£æ–¹ç¨‹ä¸€è‡´ã€‚

### æ¨¡æ‹Ÿç»“æœ
æœ¬ç®—ä¾‹ä¸ºä¸€ä¸ª$200\times50$çš„è®¡ç®—åŸŸï¼Œåˆå§‹æ—¶åˆ»æ¸©åº¦ä¸º0ï¼Œå·¦å£é¢æ¸©åº¦ä¸º1ï¼Œå³å£é¢æ¸©åº¦ä¸º0ï¼Œä¸Šå£é¢æ¸©åº¦ä¸º0ï¼Œä¸‹å£é¢ä¸ºç»çƒ­ã€‚ç®—ä¾‹çš„å‚æ•°è®¾ç½®ä¸º$\delta_x=1$ï¼Œ$\delta_t=1$ï¼Œ$\alpha=0.1$ï¼Œ$u_y=0$ï¼Œè®¡ç®—è‡³t=2000

<!-- <img src="./fig/case3-0.png" alt="Image description" width="500"/> -->
 ```{figure} fig/fig3/case3-0.png
:width: 50%
:alt: logo
:align: center
å›¾ä¸­$u_x=0.0$
```

<!-- <img src="./fig/case3-0.02.png" alt="Image description" width="500"/> -->
 ```{figure} fig/fig3/case3-0.02.png
:width: 50%
:alt: logo
:align: center
å›¾ä¸­$u_x=0.02$
```

<!-- <img src="./fig/case3-0.04.png" alt="Image description" width="500"/> -->
 ```{figure} fig/fig3/case3-0.04.png
:width: 50%
:alt: logo
:align: center
å›¾ä¸­$u_x=0.04$
```

<!-- <img src="./fig/case3-0.06.png" alt="Image description" width="500"/> -->
 ```{figure} fig/fig3/case3-0.06.png
:width: 50%
:alt: logo
:align: center
å›¾ä¸­$u_x=0.06$
```

<!-- <img src="./fig/case3-0.08.png" alt="Image description" width="500"/> -->
 ```{figure} fig/fig3/case3-0.08.png
:width: 50%
:alt: logo
:align: center
å›¾ä¸­$u_x=0.08$
```

<!-- <img src="./fig/case3-0.10.png" alt="Image description" width="500"/> -->
 ```{figure} fig/fig3/case3-0.10.png
:width: 50%
:alt: logo
:align: center
å›¾ä¸­$u_x=0.10$
```

æ¯”è¾ƒä¸åŒæ—¶åˆ»çš„ç»“æœï¼Œå¯¹æµä¸æ‰©æ•£çš„æ•ˆæœæ¸…æ™°å¯è§~

## äºŒç»´å¯¹æµæ‰©æ•£æ–¹ç¨‹çš„D2Q9æ¨¡å‹
ä»ä¸Šé¢çš„ä¸æ‰©æ•£æ–¹ç¨‹çš„æ¯”è¾ƒçœ‹å‡ºï¼Œä½¿ç”¨D1Q3æ¨¡å‹æ±‚è§£å¯¹æµæ‰©æ•£æ–¹ç¨‹ä¸æ±‚è§£æ‰©æ•£æ–¹ç¨‹å”¯ä¸€çš„ä¸åŒå°±æ˜¯å¹³è¡¡æ€åˆ†å¸ƒå‡½æ•°ã€‚åŒæ ·çš„ï¼ŒD2Q9ä¹Ÿå¦‚æ­¤ï¼Œå¹³è¡¡æ€åˆ†å¸ƒå‡½æ•°ä¸ºï¼š

$$
f_i^\mathrm{eq} = w_i \phi\left( 1 + \frac{\boldsymbol{e_i\cdot u}}{c^2_s}\right)
$$

å…¶ä»–çš„å†…å®¹ä¸ä¸Šä¸€ç« ä»‹ç»çš„D2Q9æ±‚è§£æ‰©æ•£æ–¹ç¨‹ä¸€è‡´ã€‚

### æ¨¡æ‹Ÿç»“æœ
æœ¬ç®—ä¾‹ä¸ºä¸€ä¸ª$200\times50$çš„è®¡ç®—åŸŸï¼Œåˆå§‹æ—¶åˆ»æ¸©åº¦ä¸º0ï¼Œå·¦å£é¢æ¸©åº¦ä¸º1ï¼Œå³å£é¢æ¸©åº¦ä¸º0ï¼Œä¸Šå£é¢æ¸©åº¦ä¸º0ï¼Œä¸‹å£é¢ä¸ºç»çƒ­ã€‚ç®—ä¾‹çš„å‚æ•°è®¾ç½®ä¸º$\delta_x=1$ï¼Œ$\delta_t=1$ï¼Œ$\alpha=0.1$ï¼Œ$u_y=0$,è®¡ç®—è‡³t=2000ã€‚

<!-- <img src="./fig/case4-0.png" alt="Image description" width="500"/> -->
 ```{figure} fig/fig3/case4-0.png
:width: 50%
:alt: logo
:align: center
å›¾ä¸­$u_x=0.0$
```

<!-- <img src="./fig/case4-0.02.png" alt="Image description" width="500"/> -->
 ```{figure} fig/fig3/case4-0.02.png
:width: 50%
:alt: logo
:align: center
å›¾ä¸­$u_x=0.02$
```

<!-- <img src="./fig/case4-0.04.png" alt="Image description" width="500"/> -->
 ```{figure} fig/fig3/case4-0.04.png
:width: 50%
:alt: logo
:align: center
å›¾ä¸­$u_x=0.04$
```

<!-- <img src="./fig/case4-0.06.png" alt="Image description" width="500"/> -->
 ```{figure} fig/fig3/case4-0.06.png
:width: 50%
:alt: logo
:align: center
å›¾ä¸­$u_x=0.06$
```

<!-- <img src="./fig/case4-0.08.png" alt="Image description" width="500"/> -->
 ```{figure} fig/fig3/case4-0.08.png
:width: 50%
:alt: logo
:align: center
å›¾ä¸­$u_x=0.08$
```

<!-- <img src="./fig/case4-0.10.png" alt="Image description" width="500"/> -->
 ```{figure} fig/fig3/case4-0.10.png
:width: 50%
:alt: logo
:align: center
å›¾ä¸­$u_x=0.10$
```

æ¯”è¾ƒä¸åŒæ—¶åˆ»çš„ç»“æœï¼Œå¯¹æµä¸æ‰©æ•£çš„æ•ˆæœæ¸…æ™°å¯è§~æ¯”è¾ƒD2Q9å’ŒD2Q5çš„ç»“æœï¼Œå¯ä»¥çœ‹åˆ°ä¸¤ä¸ªæ¨¡å‹è®¡ç®—çš„ç»“æœä¹Ÿéƒ½æ˜¯ä¸€è‡´çš„ã€‚
<!-- <img src="./fig/case5.png" alt="Image description" width="500"/> -->
 ```{figure} fig/fig3/case5.png
:width: 50%
:alt: logo
:align: center
$u_x=0.05$æ—¶ä¸‹è¾¹ç•Œçš„æ¸©åº¦å€¼
```

## ä»£ç ä¸‹è½½
[å¯¹æµæ‰©æ•£ä»£ç .zip](https://raw.githubusercontent.com/JR-LBM-THU/JRLBM-tutorial/main/docs/source/LBMåŸºç¡€å…¥é—¨/files/3.å¯¹æµæ‰©æ•£ä»£ç .zip)

## æ±‚æ”¯æŒï¼ğŸ¥º

å¦‚æœæ‚¨è§‰å¾—è¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œå¯ä»¥è€ƒè™‘ç”¨ä»¥ä¸‹æ–¹å¼æ”¯æŒæˆ‘ï¼š

- â˜• è¯·æˆ‘å–æ¯å’–å•¡
> å¦‚æœæ¡ä»¶å…è®¸ï¼Œ[æ¬¢è¿æèµ æ”¯æŒ](../æ”¯æŒä¸æèµ /æ”¯æŒä¸æèµ .md)ï¼  
> æ¯ä¸€åˆ†éƒ½æ˜¯å¯¹æˆ‘è«å¤§çš„é¼“åŠ±ï¼Œè®©æˆ‘èƒ½æŠ•å…¥æ›´å¤šæ—¶é—´ç»´æŠ¤å’Œæ›´æ–°ã€‚

- ğŸ“„ å¼•ç”¨æˆ‘çš„æ–‡ç« 
> å¦‚æœæš‚æ—¶ä¸ä¾¿æèµ ï¼Œ[é€‚å½“å¼•ç”¨æˆ‘çš„æ–‡ç« ](../æˆ‘çš„æ–‡ç« /æˆ‘çš„æ–‡ç« .md)ä¹Ÿæ˜¯æå¥½çš„æ”¯æŒï¼  
> æ‚¨çš„å¼•ç”¨èƒ½å¸®åŠ©è¿™ä¸ªå·¥ä½œè·å¾—æ›´å¤šå…³æ³¨ï¼ŒåŒæ ·è®©æˆ‘æ„Ÿåˆ°æ— æ¯”æ¬£æ…°ã€‚

æ— è®ºå“ªç§æ–¹å¼ï¼Œéƒ½æ˜¯å¯¹æˆ‘çš„å·¨å¤§æ”¯æŒï¼ğŸ™æ„Ÿè°¢æ‚¨è®©å¼€æºä¸–ç•Œæ›´ç¾å¥½ï¼âœ¨